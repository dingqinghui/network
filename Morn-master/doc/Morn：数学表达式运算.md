## Morn：数学表达式运算

写这个，主要是因为我不喜欢那个图形界面的运算器，我喜欢命令行。

运算不是重点，重点是表达式解析。



### 接口

```c
double mCaculate(char *str)；
```

str即为输入的表达式字符串。返回值是算的的结果。



### 工具

在[../tool](../tool)文件夹里有一个命令行计算器caculate。其使用很简单，例如

```
>1+2*3/4
result is 2.500000
>
>pi
result is 3.141593
>
>sin(pi/2)
result is 1.000000
>
>ln(e)
result is 1.000000
>
>sqrt(3^2+pow(4,2))
result is 5.000000
>
>5/0
result is 1.#INF00
>
>exit
```

退出命令行运算，输入exit。



### 规则

* 优先级
  * 括号的优先级最高，然后是正负号（+、-），其次是指数运算运算（^），再次是乘除和取余（*、/、%），优先级最低的是加减（+、-）。因此例如`-3^2`，将被解释为”负三的平方“，其运算结果为9（而不是-9）。
  * 对于连续的指数运算，从右向左运算，例如`2^3^2`，实际相当于`2^(3^2)`，结果为512。
  * 对于除乘方外相同的优先级的运算，从左向右运算。
  * 如果你记不住这些优先级，那就加括号。
* “%”在表达式中是取余的意思，而不是百分数的意思，因此：`5%+2`，将被解释为“五对正二取余”，其运算结果为1（而不是2.05）。
* 空格在表达式中没有任何作用，因此“一万”你可以写成`10000`或`10 000`，但是不能写成`10,000`。
* 数学函数名、pi（圆周率）、e（自然底数）都不区分大小写。
* 数学函数不能省略括号，例如`ln5`这种写法是不支持的，必须写成`ln(5)`。
* 乘号\*不能省略，例如`2pi`这种写法是不支持的，必须写成`2*pi`。
* 支持的函数：取绝对值abs(x)，取小值min(x1,x2)，取大值max(x1,x2)，向上取整ceil(x)，向下取整floor(x)，四舍五入取整round(x)，开方运算sqrt(x)，自然指数exp(x)（相当于`e^x`），指数运算pow(x1,x2)（相当于`x1^x2`），自然对数ln(x)（相当于`log(e,x)`），以10为底的对数log10(x)（相当于`log(10,x)`），对数运算log(x1,x2)，正弦函数sin(x)，余弦函数cos(x)，正切函数tan(x)，反正弦函数asin(x)，反余弦函数acos(x)，反正切函数atan(x)。
* 正弦函数sin(x)，余弦函数cos(x)，正切函数tan(x)的输入都是弧度制（不是角度值）。反正弦函数asin(x)，反余弦函数acos(x)，反正切函数atan(x)所得到的结果也是弧度值（不是角度值）。

